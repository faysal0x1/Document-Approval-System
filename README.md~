# Document Approval Workflow System - Complete Guide

## Table of Contents

1. 1.  System Overview
1.
1. 2.  Installation Process
1.
1. 3.  Database Setup
1.
1. 4.  Configuration
1.
1. 5.  Core Components
1.
1. 6.  Usage Guide
1.
1. 7.  Admin Guide
1.
1. 8.  Troubleshooting
1.
1. 9.  API Endpoints
1.

## System Overview

A Laravel-based document approval system with:

* *   Multi-step approval workflows
*
* *   Role-based access control
*
* *   Dynamic approver assignment
*
* *   Real-time notifications
*
* *   Document tracking
*

## Installation Process

### 1\. Prerequisites

* *   PHP 8.0+
*
* *   Composer
*
* *   MySQL 5.7+
*
* *   Node.js 14+
*
* *   Laravel 9.x
*

### 2\. Clone Repository

bash

Copy

Download

git clone https://github.com/your-repo/document-approval-system.git
cd document-approval-system

### 3\. Install Dependencies

bash

Copy

Download

composer install
npm install
npm run build

### 4\. Environment Setup

bash

Copy

Download

cp .env.example .env
php artisan key:generate

## Database Setup

### 1\. Configure .env

ini

Copy

Download

DB\_CONNECTION\=mysql
DB\_HOST\=127.0.0.1
DB\_PORT\=3306
DB\_DATABASE\=approval\_system
DB\_USERNAME\=root
DB\_PASSWORD\=

### 2\. Run Migrations

bash

Copy

Download

php artisan migrate \--seed

### 3\. Seed Initial Data

bash

Copy

Download

php artisan db:seed \--class\=WorkflowSeeder

## Configuration

### 1\. App Config

php

Copy

Download

// config/app.php
'approval' \=> \[
'default\_workflow' \=> 'leave\_application',
'max\_attachments' \=> 5,
'attachment\_size' \=> 2048, // KB
\],

### 2\. Filesystem Setup

php

Copy

Download

// config/filesystem.php
'attachments' \=> \[
'driver' \=> 'local',
'root' \=> storage\_path('app/attachments'),
'url' \=> env('APP\_URL').'/attachments',
'visibility' \=> 'private',
\],

## Core Components

### 1\. Models

Copy

Download

app/Models/
├── Document.php
├── Workflow.php
├── WorkflowStep.php
├── Approval.php
└── Attachment.php

### 2\. Services

Copy

Download

app/Services/
├── WorkflowEngine.php
├── WorkflowStepHandler.php
└── ApproverResolvers/
├── RoleBasedApproverResolver.php
├── DepartmentBasedApproverResolver.php
├── SpecificUserApproverResolver.php
└── DynamicSupervisorApproverResolver.php

### 3\. Controllers

Copy

Download

app/Http/Controllers/
├── DocumentController.php
├── ApprovalController.php
└── Admin/
├── WorkflowController.php
└── WorkflowStepController.php

## Usage Guide

### 1\. User Roles

* *   **Regular Users**: Submit documents, track status
*
* *   **Approvers**: Review and approve/reject requests
*
* *   **Admins**: Configure workflows, manage users
*

### 2\. Submitting Documents

php

Copy

Download

// Example submission
$document \= Document::create(\[
'type' \=> 'leave\_application',
'content' \=> \[
'start\_date' \=> '2023-06-01',
'end\_date' \=> '2023-06-05',
'reason' \=> 'Annual leave'
\],
'submitter\_id' \=> auth()\->id()
\]);

// Start workflow
app(WorkflowEngine::class)\->startWorkflow($document);

### 3\. Approval Process

php

Copy

Download

// Approving
$approval\->update(\[
'status' \=> 'approved',
'approved\_at' \=> now(),
'comments' \=> 'Looks good'
\]);

// Rejecting
$approval\->update(\[
'status' \=> 'rejected',
'approved\_at' \=> now(),
'comments' \=> 'Missing information'
\]);

## Admin Guide

### 1\. Creating Workflows

bash

Copy

Download

php artisan make:workflow LeaveApplicationWorkflow

### 2\. Defining Steps

php

Copy

Download

WorkflowStep::create(\[
'workflow\_id' \=> $workflow\->id,
'step\_number' \=> 1,
'name' \=> 'Manager Approval',
'approver\_type' \=> 'dynamic',
'approver\_value' \=> 'supervisor\_id',
'description' \=> 'First level approval'
\]);

### 3\. Managing Approvers

php

Copy

Download

// Role-based
$resolver \= new RoleBasedApproverResolver();
$approver \= $resolver\->resolve($step, $document);

// Department-based
$resolver \= new DepartmentBasedApproverResolver();
$approver \= $resolver\->resolve($step, $document);

## Troubleshooting

### Common Issues

**1\. "No approver found"**

bash

Copy

Download

\# Check workflow steps
php artisan workflow:debug {document\_id}

**2\. "View not found"**

bash

Copy

Download

\# Publish views
php artisan vendor:publish \--tag\=views

**3\. Queue Workers Not Running**

bash

Copy

Download

\# Start queue worker
php artisan queue:work

## API Endpoints

### Documents

* *   `POST /api/documents` \- Submit new document
*
* *   `GET /api/documents` \- List user's documents
*
* *   `GET /api/documents/{id}` \- Get document details
*

### Approvals

* *   `POST /api/approvals/{id}/approve` \- Approve document
*
* *   `POST /api/approvals/{id}/reject` \- Reject document
*

### Admin

* *   `GET /api/admin/workflows` \- List workflows
*
* *   `POST /api/admin/workflows` \- Create workflow
*
* *   `PUT /api/admin/workflows/{id}` \- Update workflow
*

## Deployment

### 1\. Production Setup

bash

Copy

Download

composer install --optimize-autoloader --no-dev
npm run production
php artisan config:cache
php artisan route:cache
php artisan view:cache

### 2\. Queue Setup

bash

Copy

Download

\# Supervisor config
\[program:approval-worker\]
process\_name\=%(program\_name)s\_%(process\_num)02d
command\=php /var/www/approval-system/artisan queue:work \--sleep\=3 \--tries\=3
autostart\=true
autorestart\=true
user\=www-data
numprocs\=4
redirect\_stderr\=true
stdout\_logfile\=/var/log/approval-worker.log